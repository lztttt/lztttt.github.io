const ver="20.20.4601";navigator.cookieEnabled||showDialog(i18n[lang].cookieDisabled,{ok:null});const $_GET=(()=>{const a={};if(location.search){const b=location.search.replace("?","").split("&");for(let c=0;c<b.length;c++){const d=b[c].split("=");a[d[0]]=decodeURIComponent(d[1])}}return a})(),backend="https://tool.retiehe.com/backend/",enRegExp=/[a-z]/i,isAndroid=/Android/i.test(navigator.userAgent),isApp=!!window._cordovaNative||document.body.classList.add("browser")||!1,isiOS=/iPhone|iPad/i.test(navigator.userAgent),isTencent=/(MicroMessenger|QQ)\//i.test(navigator.userAgent),mask=document.createElement("div"),numRegExp=/\d+/,uppercaseRegExp=/[A-Z]+/,zhRegExp=/[\u4E00-\u9FA5]+/,isMobile=isAndroid||isiOS;function addZero(a,b){return(Array(b).join("0")+(a||0)).slice(-b)}function ajax(a){const b="POST"==a.method,c=a.showLoading&&showToast(),d=b?getPostData(a.data):{};c&&c.show(b?i18n[lang].submitting:i18n[lang].loading),b||(a.url=getRequestURL(a.url+(a.data?"?"+encodeData(a.data):""))),fetch(a.url,d).then(b=>(c&&c.close(),b.ok?"json"==a.dataType?b.json():b.text():(a.error&&a.error(b),!1))).then(b=>{!1!==b&&a.success&&a.success(b)}).catch(b=>{c&&c.close(),a.error&&a.error(b)})}function calc(a){const b=new Function("x","y","z","const abs=Math.abs,arccos=Math.acos,arccosh=Math.acosh,arccot=num=>{return Math.atan(1/num)},arccsc=num=>{return Math.asin(1/num)},arcsec=num=>{return Math.acos(1/num)},arcsin=Math.asin,arcsinh=Math.asinh,arctan=Math.atan,arctanh=Math.atanh,cbrt=Math.cbrt,ceil=Math.ceil,cos=Math.cos,cosh=Math.cosh,cot=num=>{return 1/Math.tan(num)},csc=num=>{return 1/Math.sin(num)},e=Math.E,exp=Math.exp,floor=Math.floor,ln=Math.log,log10=Math.log10,log2=Math.log2,pi=Math.PI,pow=Math.pow,random=Math.random,round=Math.round,sec=num=>{return 1/Math.cos(num)},sin=Math.sin,sinh=Math.sinh,sqrt=Math.sqrt,tan=Math.tan,tanh=Math.tanh,trunc=Math.trunc;return "+a);let c=b(Math.random(),Math.random(),Math.random()),d=0,e=0;if("boolean"==typeof c&&/==|<|>/.test(a)&&/x|y|z/.test(a)&&!/for|if|while/.test(a)){for(let a=0;10>a;a++)b(Math.random(),Math.random(),Math.random())?e+=1:d+=1;c=e>d}return c}function clearClass(a){const b=document.getElementsByClassName(a);for(let c=0;c<b.length;c++)rmElement(b[c])}function closeMenu(){0<document.getElementsByClassName("popup-menu").length&&(mask.classList.add("hidden"),clearClass("popup-menu"))}function decrypt(a,b){const c=a.split("9");let d="";for(let e=0;e<c.length;e++)d+=String.fromCharCode(parseInt(c[e],8)/8);if(-1!=d.indexOf("\u4E28"))return b&&MD5(b)==d.substr(d.indexOf("\u4E28")+1,32)?d.substr(0,d.indexOf("\u4E28")):a}function downloadText(a,b){const c=document.createElement("a");c.href="data:text/plain;charset=utf-8,"+encodeURIComponent(a),c.download=b,c.click()}function encodeData(a){const b=[];for(const c in a)a[c]&&b.push(c+"="+encodeURIComponent(a[c]));return b.join("&")}function error(a){showDialog(a?a.status?i18n[lang].unableConnectServer+a.status:a:i18n[lang].unknownErrorEncountered,{ok:null})}function getPostData(a){const b=new FormData;for(const c in a)(a[c]||0===a[c])&&b.append(c,a[c]);return{body:b,credentials:"omit",method:"POST"}}function getRequestURL(a){return a.startsWith(backend)||a.startsWith("data:")?a:"https://tool.retiehe.com/backend/get?"+encodeData({url:a})}function getUserData(a,b,c,d){login.username&&ajax({url:"https://tool.retiehe.com/backend/get",data:{token:login.token,url:a,username:login.username},dataType:"json",showLoading:!d,success:a=>{b&&b(a)},error:a=>{c&&c(a)}})}function goTo(a,b){location.hostname?"index"==a&&(a="./"):a+=".html",b&&(a+="?"+encodeData(b)),location.href=a}function initCalculator(a,b){document.title=i18n[lang].calculator+i18n[lang].titleSuffix,document.getElementsByClassName("mui-title")[0].innerText=i18n[lang].calculator;const c=document.getElementsByTagName("input");for(let d=0;d<=a;d++)c[d].placeholder=i18n[lang].enterNumber,isAndroid&&(c[d].type="text"),c[d].oninput=function(){const a=this.id.replace("Input",""),c=a.replace(/[A-Za-z]+/g,""),d=a.replace(c,"")+"<sub>"+c+"</sub>",e=document.getElementById(a+"Label");e.innerHTML=this.value||d,b()},c[d].onclick=()=>{isMobile&&showPrompt({callback:a=>{document.getElementById(c[d].id).value=a,document.getElementById(c[d].id).oninput()},default:document.getElementById(c[d].id).value,empty:()=>{document.getElementById(c[d].id).value=0,document.getElementById(c[d].id).oninput()},text:i18n[lang].enterNumber,type:document.getElementById(c[d].id).type})}}function initTextHist(){loadJs("vue",()=>{window.hist=new Vue({el:"#history",data:{list:[]},computed:{reversed:function(){for(let a=0;a<this.list.length;a++)this.list[a].encrypt&&(this.list[a].text=decrypt(this.list[a].text,"RTH"));return this.list.slice().reverse()}},methods:{add:function(a){a&&(()=>{const b=a.removeLineBreaks();for(let a=0;a<this.list.length;a++)if(this.list[a].text.removeLineBreaks()==b)return!1;return!0})()&&this.list.push({text:a})},clicked:function(a){document.getElementById("main").scrollTop=0;const b=document.getElementsByTagName("textarea")[0]||document.getElementsByTagName("input")[0];b.value=this.reversed[a].text,"function"==typeof start&&start()}}}),window.load=()=>{if(""===login.username)localStorage.removeItem("SavedText");else if(login.username){const a=localStorage.getItem("SavedText");hist.list=a&&JSON.parse(a).text||[],fetch("https://tool.retiehe.com/backend/text/get?"+encodeData({token:login.token,username:login.username})).then(a=>a.json()).then(a=>{a&&(hist.list=a.text)})}}})}function isOnly(a,b){const c=b.split("");let d="";for(let e=0;e<c.length;e++)a.test(c[e])&&(d+=c[e]);return d==b}function loadJs(){const a={cordova:[window.cordova,"cordova.js"],csv:[window.parse,"vendor/csv.min.js"],login:[window.login,"https://tool.retiehe.com/backend/code?"+encodeData({appname:"RTH Toolbox"})],md5:[window.MD5,"vendor/md5.min.js"],qrcode:[window.QRCode,"vendor/qrcode.min.js"],vue:[window.Vue,"vendor/vue.min.js"],waves:[window.Waves,"vendor/waves.min.js"],xmorse:[window.xmorse,"vendor/xmorse.min.js"]};let b=arguments;"function"==typeof b[1]&&(b=[b]);for(let c=0;c<b.length;c++)"string"==typeof b[c]&&(b[c]=[b[c]]),a[b[c][0]]&&a[b[c][0]][0]?b[c][1]&&b[c][1]():setTimeout(()=>{const d=document.createElement("script");d.src=a[b[c][0]]&&a[b[c][0]][1]||b[c][0],d.onerror=b[c][2],d.onload=b[c][1],document.body.appendChild(d)},1)}function loadLinks(){if(location.hostname){const a=document.getElementsByTagName("a");for(let b=0;b<a.length;b++){const c=a[b].href;c.endsWith(".html")&&(a[b].href=c.substring(c.lastIndexOf("/")+1,c.length-5))}}}function loadSpeakerBtn(){const a=document.getElementsByClassName("speaker");for(let b=0;b<a.length;b++)a[b].setAttribute("aria-label",i18n[lang].speak)}function loadWaves(){loadJs("waves",()=>{Waves.attach("button",["waves-light"]),Waves.attach("footer div"),Waves.init()})}function loggedIn(a){a&&rmElement(document.getElementsByClassName("popup")[0]),"function"==typeof load&&load()}function loggedOut(){localStorage.clear()}function loginDialog(){if("function"==typeof codeLoad&&!login.username){document.getElementsByClassName("popup")[0]&&rmElement(document.getElementsByClassName("popup")[0]);const a=document.createElement("div"),b=document.createElement("iframe"),c=document.createElement("div");a.classList.add("popup","fade-in"),a.tabIndex="0",a.setAttribute("aria-label",b.title=i18n[lang].login),450>=innerWidth&&"Dark"==theme?(a.style.backgroundColor="rgb(20,20,20)",b.src="https://account.retiehe.com/login.html?"+encodeData({theme:"dark"})):(a.classList.add("light-bg"),b.src="https://account.retiehe.com/login.html"),c.classList.add("close"),c.tabIndex="0",c.setAttribute("role","button"),c.setAttribute("aria-label",i18n[lang].close),c.onclick=()=>{rmElement(a)},a.appendChild(b),a.appendChild(c),document.body.appendChild(a),a.focus()}}function loginRequired(a,b){window.login&&(login.username||login.username===void 0?a&&a():(b&&b(),loginDialog()))}function openDialog(){document.getElementById("file").value="",document.getElementById("file").onchange=a=>{openFile(a.target.files[0])},document.getElementById("file").click()}function rmElement(a){a&&(a.classList.contains("fade-in")?(a.style.opacity="0",setTimeout(()=>{a.parentElement&&a.parentElement.removeChild(a)},250)):a.parentElement&&a.parentElement.removeChild(a))}function showDialog(a,b){clearClass("msg-box");const c=b&&"calc("+100/Object.keys(b).length+"% - 2px)",d=document.createElement("div"),e=document.createElement("div");for(const f in d.classList.add("popup","msg-box","fade-in"),e.classList.add("text","selectable"),e.innerHTML=a,d.appendChild(e),b){const e=document.createElement("button");switch(e.style.width=c,f){case"ok":case"yes":e.classList.add("default-btn","waves-effect");break;default:e.classList.add("waves-effect");}e.innerText=i18n[lang][f],e.setAttribute("aria-label",a+" "+i18n[lang][f]),e.onclick=a=>{"function"==typeof b[f]&&b[f](a),rmElement(d)},d.appendChild(e)}document.body.appendChild(d);let f=document.getElementsByClassName("default-btn");f=f[f.length-1],f&&f.focus()}function showImage(a,b){rmElement(document.getElementsByClassName("img")[0]);const c=document.createElement("div"),d=document.createElement("div"),e=document.createElement("div");if(c.classList.add("img","fade-in"),d.classList.add("img-title"),d.innerText=i18n[lang].image,d.onmousedown=d.ontouchstart=a=>{c.style.transition="none";const b=c.offsetLeft,e={},f=c.offsetTop;a.touches?(e.x=a.touches[0].clientX,e.y=a.touches[0].clientY):(e.x=a.clientX,e.y=a.clientY),onmousemove=d.ontouchmove=a=>{a.preventDefault();let d,g;a.touches?(d=a.touches[0].clientX,g=a.touches[0].clientY):(d=a.clientX,g=a.clientY),c.style.left=b+d-e.x+"px",c.style.top=f+g-e.y+"px"},onmouseup=d.ontouchend=()=>{onmousemove=d.ontouchmove=c.style.transition=null}},e.classList.add("close"),e.tabIndex="0",e.setAttribute("role","button"),e.setAttribute("aria-label",i18n[lang].close),e.onclick=()=>{rmElement(c)},d.appendChild(e),c.appendChild(d),a){const e=new Image;a=getRequestURL(a),e.src=a,e.alt=b,e.onload=function(){const a=this.offsetHeight+d.offsetHeight;c.style.height=a+"px",c.style.top="calc(50vh - "+a/2+"px)",setTimeout(()=>{this.style.opacity="1"},250)},c.appendChild(e)}return document.body.appendChild(c),c}function showMenu(a,b,c={}){rmElement(document.getElementsByClassName("popup-menu")[0]);const d=document.createElement("div");mask.classList.remove("hidden"),d.classList.add("popup-menu","fade-in"),c.vertical&&d.classList.add("vertical"),d.tabIndex="0",d.setAttribute("aria-label",i18n[lang].popup),d.oncontextmenu=()=>!1;for(let e=0;e<b.length;e++)if(b[e].if===void 0||b[e].if){const a=document.createElement("span");a.innerText=b[e].text,a.tabIndex="0",a.setAttribute("aria-label",b[e].ariaLabel),a.onclick=b[e].onclick,d.appendChild(a)}document.body.appendChild(d);const e=d.getBoundingClientRect();a.x&&a.y?(0>a.x-e.width/2?d.style.left="0":a.x-e.width/2>document.documentElement.clientWidth-e.width?d.style.right="0":d.style.left=a.x-e.width/2+"px",d.style.top=a.y+10>document.documentElement.clientHeight-e.height?a.y-e.height-10+"px":a.y+10+"px"):(d.style.left=document.documentElement.clientWidth/2-e.width/2+"px",d.style.top=document.documentElement.clientHeight/2-e.height/2+"px"),d.focus()}function showNotification(a,b){if(window.Notification&&"granted"==Notification.permission){const c={body:a,icon:"https://cdn.jsdelivr.net/gh/shangzhenyang/assets/img/icon-512.png"};b=b||i18n[lang].newMessage,isMobile?navigator.serviceWorker.ready.then(a=>{a.showNotification(b,c)}):new Notification(b,c)}}function showParenthesis(a){if(a){let b=document.getElementsByClassName("title-parenthesis")[0];b||(b=document.createElement("span"),b.classList.add("title-parenthesis"),document.getElementsByClassName("mui-title")[0].appendChild(b)),b.innerText=a}else rmElement(document.getElementsByClassName("title-parenthesis")[0])}function showPrompt(a){const b=document.createElement("div"),c=document.createElement(a.options?"select":"input"),d=document.createElement("button"),e=document.createElement("button");if(b.classList.add("popup","prompt","fade-in"),a.options)for(let b=0;b<a.options.length;b++)"string"==typeof a.options[b]?c.options.add(new Option(a.options[b])):(void 0===a.options[b].if||a.options[b].if)&&c.options.add(new Option(a.options[b].text,a.options[b].value));else c.type=a.type||"text","string"==typeof a.text&&(c.placeholder=a.text),a.oninput&&(c.oninput=function(){a.oninput(this.value)}),c.onkeydown=a=>{if(13==a.keyCode)e.click();else switch(a.key){case"Escape":d.click();}};a.default&&(c.value=a.default),d.classList.add("waves-effect"),d.onclick=()=>{a.cancel&&a.cancel(),rmElement(b)},d.innerText=i18n[lang].cancel,e.classList.add("waves-effect"),e.onclick=()=>{c.value?a.callback&&a.callback(c.value):a.empty&&a.empty(),setTimeout(()=>{rmElement(b)},25)},e.innerText=i18n[lang].ok,b.appendChild(c),b.appendChild(d),b.appendChild(e),document.body.appendChild(b),c.focus()}function showQrCode(a){const b=showImage(),c=document.createElement("div");b.classList.add("qr-code-container"),c.classList.add("qr-code"),new QRCode(c,{height:195,text:a,width:195}),b.appendChild(c)}function showToast(a){clearClass("toast");const b=document.createElement("div"),c=()=>{b.classList.remove("fade-in"),setTimeout(()=>{b.classList.add("fade-out"),setTimeout(()=>{rmElement(b)},250)},1)};return b.classList.add("toast","fade-in"),a&&(b.innerText=a),document.body.appendChild(b),a?void setTimeout(c,2e3):(b.classList.add("hidden"),{close:()=>{c()},show:a=>{a&&(b.innerText=a,b.classList.remove("hidden"))}})}function speak(a,b){if(a)if(!b&&window.speechSynthesis)onbeforeunload||(onbeforeunload=()=>{speechSynthesis.cancel()}),speechSynthesis.cancel(),speechSynthesis.speak(new SpeechSynthesisUtterance(a));else{b&&"auto"!=b&&"cht"!=b&&"wyw"!=b||(b=zhRegExp.test(a)?"zh":"en"),showToast(i18n[lang].loadingAudio);const c=new Audio("https://fanyi.baidu.com/gettts?"+encodeData({lan:b,spd:6,text:a}));c.onerror=()=>{showDialog(i18n[lang].unableLoadAudio,{ok:null})},c.play()}}function translate(a,b,c,d,e){const f=Date.now(),g=MD5("20171109000093780"+a+f+"ZR6EGbP8ZzwU7GookTvy");"auto"==c&&(c=enRegExp.test(a)?"zh":"en"),ajax({url:"http://api.fanyi.baidu.com/api/trans/vip/translate",data:{q:a,appid:"20171109000093780",salt:f,from:b,to:c,sign:g},dataType:"json",showLoading:!0,success:a=>{a&&a.trans_result&&d&&d(a.trans_result[0].dst,a)},error:a=>{e?e():error(a)}})}!Element.prototype.requestFullscreen&&Element.prototype.webkitRequestFullScreen&&(Element.prototype.requestFullscreen=Element.prototype.webkitRequestFullScreen),String.prototype.replaceAll||(String.prototype.replaceAll=function(a,b){let c=this;for(;-1!=c.indexOf(a);)c=c.replace(a,b);return c}),String.prototype.removeLineBreaks=function(){return this.replaceAll("\n"," ")},ondragover=a=>{a.preventDefault()},ondrop=a=>{a.preventDefault(),"function"==typeof openFile&&openFile(a.dataTransfer.files[0])},(()=>{const a=JSON.parse(localStorage.getItem("BackgroundImage"))||{},b=document.getElementsByTagName("header")[0],c=document.getElementById("user"),d=()=>{document.documentElement.style.setProperty("--background-image","url(\""+a.url+"\")"),a.element.src=a.url};if(a.element=document.getElementsByClassName("bg-img")[0],a.element.onload=function(){this.classList.remove("hidden")},b||matchMedia("(display-mode: standalone)").matches){const a=document.createElement("meta");a.name="theme-color",a.content=b&&450>=innerWidth?"#0066cc":"#ffffff",document.head.appendChild(a)}b&&(document.getElementById("back").setAttribute("aria-label",i18n[lang].back),document.getElementById("back").onclick=()=>{1>=window.history.length?goTo("index"):history.go(-1)},c&&(c.setAttribute("aria-label",i18n[lang].user),c.onclick=a=>{"function"==typeof codeLoad?loginRequired(()=>{showMenu(a,[{ariaLabel:i18n[lang].myAccount,onclick:()=>{open("https://account.retiehe.com/?"+encodeData(login)),closeMenu()},text:login.email},{onclick:()=>{showToast().show(i18n[lang].loggingOut),logOut(),closeMenu()},text:i18n[lang].logOut}])}):showToast(i18n[lang].noInternet)})),"zh-CN"===lang?window.langOpt=[["\u82F1\u8BED","en"],["\u7B80\u4F53\u4E2D\u6587","zh"],["\u7E41\u4F53\u4E2D\u6587","cht"],["\u6587\u8A00\u6587","wyw"],["\u7CA4\u8BED","yue"],["\u65E5\u8BED","jp"],["\u97E9\u8BED","kor"],["\u6CD5\u8BED","fra"],["\u897F\u73ED\u7259\u8BED","spa"],["\u6CF0\u8BED","th"],["\u963F\u62C9\u4F2F\u8BED","ara"],["\u4FC4\u8BED","ru"],["\u8461\u8404\u7259\u8BED","pt"],["\u5FB7\u8BED","de"],["\u610F\u5927\u5229\u8BED","it"],["\u5E0C\u814A\u8BED","el"],["\u8377\u5170\u8BED","nl"],["\u6CE2\u5170\u8BED","pl"],["\u4FDD\u52A0\u5229\u4E9A\u8BED","bul"],["\u7231\u6C99\u5C3C\u4E9A\u8BED","est"],["\u4E39\u9EA6\u8BED","dan"],["\u82AC\u5170\u8BED","fin"],["\u6377\u514B\u8BED","cs"],["\u7F57\u9A6C\u5C3C\u4E9A\u8BED","rom"],["\u65AF\u6D1B\u6587\u5C3C\u4E9A\u8BED","slo"],["\u745E\u5178\u8BED","swe"],["\u5308\u7259\u5229\u8BED","hu"],["\u8D8A\u5357\u8BED","vie"]]:"zh-TW"===lang?window.langOpt=[["\u82F1\u8A9E","en"],["\u7C21\u9AD4\u4E2D\u6587","zh"],["\u7E41\u9AD4\u4E2D\u6587","cht"],["\u6587\u8A00\u6587","wyw"],["\u7CB5\u8A9E","yue"],["\u65E5\u8A9E","jp"],["\u97D3\u8A9E","kor"],["\u6CD5\u8A9E","fra"],["\u897F\u73ED\u7259\u8A9E","spa"],["\u6CF0\u8A9E","th"],["\u963F\u62C9\u4F2F\u8A9E","ara"],["\u4FC4\u8A9E","ru"],["\u8461\u8404\u7259\u8A9E","pt"],["\u5FB7\u8A9E","de"],["\u610F\u5927\u5229\u8A9E","it"],["\u5E0C\u81D8\u8A9E","el"],["\u8377\u862D\u8A9E","nl"],["\u6CE2\u862D\u8A9E","pl"],["\u4FDD\u52A0\u5229\u4E9E\u8A9E","bul"],["\u611B\u6C99\u5C3C\u4E9E\u8A9E","est"],["\u4E39\u9EA5\u8A9E","dan"],["\u82AC\u862D\u8A9E","fin"],["\u6377\u514B\u8A9E","cs"],["\u7F85\u99AC\u5C3C\u4E9E\u8A9E","rom"],["\u65AF\u6D1B\u6587\u5C3C\u4E9E\u8A9E","slo"],["\u745E\u5178\u8A9E","swe"],["\u5308\u7259\u5229\u8A9E","hu"],["\u8D8A\u5357\u8A9E","vie"]]:"en-US"===lang?window.langOpt=[["English","en"],["Simplified Chinese","zh"],["Traditional Chinese","cht"],["Classical Chinese","wyw"],["Cantonese","yue"],["Japanese","jp"],["Korean","kor"],["French","fra"],["Spanish","spa"],["Thai","th"],["Arabic","ara"],["Russia","ru"],["Portuguese","pt"],["German","de"],["Italian","it"],["Greek","el"],["Dutch","nl"],["Polish","pl"],["Bulgarian","bul"],["Estonian","est"],["Danish","dan"],["Finnish","fin"],["Czech","cs"],["Romanian","rom"],["Slovenian","slo"],["Swedish","swe"],["Hungarian","hu"],["Vietnamese","vie"]]:void 0,document.documentElement.lang=lang,!a.url||864e5<Date.now()-a.time?fetch("https://cdn.jsdelivr.net/gh/shangzhenyang/assets/img/bing/").then(a=>a.text()).then(b=>{const c=b.split("<a rel=\"nofollow\" href=\"");c.splice(0,1);for(let a=0;a<c.length;a++)c[a]=c[a].split("\"")[0];a.url="https://cdn.jsdelivr.net"+c[Math.floor(Math.random()*c.length)],d(),localStorage.setItem("BackgroundImage",JSON.stringify({time:Date.now(),url:a.url}))}):d(),addEventListener("load",()=>{document.body.classList.remove("preload"),(!b||c)&&loadJs("login",()=>{"function"==typeof codeLoad&&codeLoad(),login.username||"function"!=typeof load||load()},()=>{window.login=window.login||{},loggedIn()}),mask.classList.add("mask","hidden"),mask.tabIndex="0",mask.setAttribute("aria-label",i18n[lang].closePopup),mask.oncontextmenu=()=>!1,mask.onclick=closeMenu,document.body.appendChild(mask)})})();